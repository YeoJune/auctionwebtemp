<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>회원 관리</title>
    <link rel="stylesheet" href="/styles/common.css" />
    <link rel="stylesheet" href="/styles/admin/common.css" />
    <link rel="stylesheet" href="/styles/admin/admin.css" />
    <link rel="stylesheet" href="/styles/admin/users.css" />
  </head>
  <body>
    <div class="admin-layout">
      <!-- 사이드바 -->
      <div class="sidebar">
        <div class="sidebar-logo">
          <h2>경매 관리자</h2>
        </div>
        <div class="sidebar-menu">
          <a href="/admin">대시보드</a>
          <a href="/admin/live-bids">현장 경매 관리</a>
          <a href="/admin/direct-bids">직접 경매 관리</a>
          <a href="/admin/all-bids">통합 경매 관리</a>
          <a href="/admin/invoices">인보이스 관리</a>
          <a href="/admin/users" class="active">회원 관리</a>
          <a href="/admin/recommend-filters">추천 및 필터</a>
          <a href="/admin/settings">관리자 설정</a>
        </div>
      </div>

      <!-- 메인 콘텐츠 -->
      <div class="main-content">
        <div class="main-header">
          <h1>회원 관리</h1>
          <div class="user-info" style="display: flex; align-items: center">
            <!-- 간단한 토글 버튼 -->
            <div class="admin-switch">
              <a href="#" class="active">경매 관리</a>
              <a href="https://cassystem.com/admin" class="inactive"
                >명품감정</a
              >
            </div>

            관리자
            <button id="logoutBtn" class="btn btn-secondary">로그아웃</button>
          </div>
        </div>

        <!-- 회원 추가 버튼 -->
        <div class="action-buttons mb-3">
          <button id="addUserBtn" class="btn">새 회원 등록</button>
          <button id="syncSheetsBtn" class="btn btn-secondary">
            시트 동기화
          </button>
        </div>

        <!-- 회원 목록 테이블 -->
        <div class="card">
          <table class="data-table" id="usersTable">
            <thead>
              <tr>
                <th>아이디</th>
                <th>회원 구분</th>
                <th>예치금/한도</th>
                <th>가입일</th>
                <th>업체명</th>
                <th>연락처</th>
                <th>수수료율</th>
                <th>상태</th>
                <th>작업</th>
              </tr>
            </thead>
            <tbody id="usersTableBody">
              <tr>
                <td colspan="9" class="text-center">
                  데이터를 불러오는 중입니다...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- 회원 추가/수정 모달 -->
    <div class="modal-overlay" id="userFormModal">
      <div class="modal-dialog">
        <div class="modal-header">
          <h3 class="modal-title" id="userFormTitle">새 회원 등록</h3>
          <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
          <form id="userForm">
            <input type="hidden" id="editMode" value="0" />
            <div class="form-group">
              <label class="form-label" for="userId">아이디 *</label>
              <input type="text" id="userId" class="form-control" required />
            </div>
            <div class="form-group">
              <label class="form-label" for="userPassword">비밀번호 *</label>
              <input
                type="password"
                id="userPassword"
                class="form-control"
                required />
            </div>
            <div class="form-group">
              <label class="form-label" for="registrationDate">가입일</label>
              <input type="date" id="registrationDate" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label" for="businessNumber"
                >사업자등록번호</label
              >
              <input
                type="text"
                id="businessNumber"
                class="form-control"
                placeholder="000-00-00000" />
            </div>
            <div class="form-group">
              <label class="form-label" for="companyName">업체명</label>
              <input type="text" id="companyName" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label" for="phone">연락처</label>
              <input
                type="tel"
                id="phone"
                class="form-control"
                placeholder="010-0000-0000" />
            </div>
            <div class="form-group">
              <label class="form-label" for="userEmail">이메일</label>
              <input type="email" id="userEmail" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label" for="address">주소</label>
              <textarea id="address" class="form-control" rows="2"></textarea>
            </div>
            <div class="form-group">
              <label class="form-label" for="commissionRate"
                >수수료율 (%)</label
              >
              <input
                type="number"
                id="commissionRate"
                class="form-control"
                step="0.01"
                min="0"
                max="100"
                placeholder="예: 5.00" />
            </div>

            <!-- 회원 구분 -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-user-tag"></i> 회원 구분 *
              </label>
              <div class="radio-group">
                <label class="radio-label">
                  <input
                    type="radio"
                    name="accountType"
                    value="individual"
                    checked />
                  <span>개인 회원 (선불제)</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="accountType" value="corporate" />
                  <span>기업 회원 (후불제)</span>
                </label>
              </div>
              <small class="form-text text-muted">
                개인 회원은 예치금 충전 후 입찰, 기업 회원은 한도 내 입찰 후
                정산
              </small>
            </div>

            <!-- 예치금 (개인 회원용) -->
            <div class="form-group" id="depositBalanceGroup">
              <label class="form-label" for="depositBalance">
                <i class="fas fa-wallet"></i> 현재 예치금 (원)
              </label>
              <input
                type="number"
                id="depositBalance"
                class="form-control"
                placeholder="0"
                min="0"
                step="1000"
                readonly />
              <small class="form-text text-muted">
                예치금은 직접 수정할 수 없습니다. 거래 내역 관리 페이지에서
                조정하세요.
              </small>
            </div>

            <!-- 일일 한도 (기업 회원용) -->
            <div class="form-group" id="dailyLimitGroup" style="display: none">
              <label class="form-label" for="dailyLimit">
                <i class="fas fa-chart-line"></i> 일일 한도 (원) *
              </label>
              <input
                type="number"
                id="dailyLimit"
                class="form-control"
                placeholder="예: 10000000"
                min="0"
                step="1000000" />
              <small class="form-text text-muted">
                기업 회원이 하루에 사용 가능한 최대 금액
              </small>
            </div>

            <!-- 오늘 사용액 (기업 회원용) -->
            <div class="form-group" id="dailyUsedGroup" style="display: none">
              <label class="form-label" for="dailyUsed">
                <i class="fas fa-receipt"></i> 오늘 사용액 (원)
              </label>
              <input
                type="number"
                id="dailyUsed"
                class="form-control"
                placeholder="0"
                readonly />
              <small class="form-text text-muted">
                오늘 사용한 금액 (읽기 전용)
              </small>
            </div>

            <div class="form-group">
              <label class="form-label">상태</label>
              <div class="radio-group">
                <label>
                  <input type="radio" name="userStatus" value="true" checked />
                  활성
                </label>
                <label>
                  <input type="radio" name="userStatus" value="false" />
                  비활성
                </label>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary close-modal">취소</button>
          <button class="btn" id="saveUserBtn">저장</button>
        </div>
      </div>
    </div>

    <!-- 공통 스크립트 먼저 로드 -->
    <script src="/js/common.js"></script>
    <script src="/js/api.js"></script>

    <!-- Admin 전용 스크립트 -->
    <script src="/js/admin/common.js"></script>
    <script src="/js/admin/api.js"></script>
    <script src="/js/admin/users.js"></script>
  </body>
</html>
