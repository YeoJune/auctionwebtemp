<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>통합 경매 관리</title>
    <link rel="stylesheet" href="/styles/common.css" />
    <link rel="stylesheet" href="/styles/admin/common.css" />
    <link rel="stylesheet" href="/styles/admin/bids.css" />
    <link rel="stylesheet" href="/styles/admin/unified.css" />
  </head>
  <body>
    <div class="admin-layout">
      <!-- 사이드바 -->
      <div class="sidebar">
        <div class="sidebar-logo">
          <h2>경매 관리자</h2>
        </div>
        <div class="sidebar-menu">
          <a href="/admin">대시보드</a>
          <a href="/admin/live-bids">현장 경매 관리</a>
          <a href="/admin/direct-bids">직접 경매 관리</a>
          <a href="/admin/all-bids" class="active">통합 경매 관리</a>
          <a href="/admin/bid-results">입찰 결과 & 정산</a>
          <a href="/admin/transactions">거래 내역 관리</a>
          <a href="/admin/invoices">인보이스 관리</a>
          <a href="/admin/users">회원 관리</a>
          <a href="/admin/recommend-filters">추천 및 필터</a>
          <a href="/admin/settings">관리자 설정</a>
          <a href="/admin/wms">WMS(입고/수선/출고)</a>
          <a href="/admin/repair-management">수선 관리</a>
          <a href="/admin/activity-logs">사용자 활동기록</a>
          <a href="/admin/admin-permissions">관리자 권한 관리</a>
        </div>
      </div>

      <!-- 메인 콘텐츠 -->
      <div class="main-content">
        <div class="main-header">
          <h1>통합 경매 관리</h1>
          <div class="user-info" style="display: flex; align-items: center">
            <!-- 간단한 토글 버튼 -->
            <div class="admin-switch">
              <a href="#" class="active">경매 관리</a>
              <a href="https://cassystem.com/admin" class="inactive"
                >명품감정</a
              >
            </div>

            관리자
            <button id="logoutBtn" class="btn btn-secondary">로그아웃</button>
          </div>
        </div>

        <!-- 검색 & 빠른 필터 -->
        <div class="all-bids-search-section">
          <div class="all-bids-search-row">
            <div class="search-input-wrap">
              <input type="text" id="unifiedSearchInput" placeholder="상품ID, 제목, 브랜드, 유저ID 검색" />
              <button id="unifiedSearchBtn" class="btn">조회</button>
              <button id="clearUnifiedSearchBtn" class="btn btn-ghost">초기화</button>
              <div class="unified-page-size">
                <label for="unifiedPageSize">페이지당</label>
                <select id="unifiedPageSize" class="form-control form-control-sm">
                  <option value="100" selected>100</option>
                  <option value="300">300</option>
                  <option value="500">500</option>
                </select>
              </div>
            </div>
          </div>
          <div class="quick-filters">
            <span class="quick-filters-label">바로 보기</span>
            <div class="quick-filters-segmented">
              <button type="button" onclick="showUnsubmitted()" class="quick-filter-btn">
                <span>미반영</span>
                <span class="quick-count" id="quickUnsubmittedCount">-</span>
              </button>
              <button type="button" onclick="showSecondProposals()" class="quick-filter-btn">
                <span>2차 제안 대기</span>
                <span class="quick-count" id="quickSecondCount">-</span>
              </button>
              <button type="button" onclick="resetFilters()" class="quick-filter-btn">
                <span>전체 보기</span>
              </button>
            </div>
          </div>
        </div>

        <!-- 결과 영역 -->
        <div class="all-bids-results-section">
          <div class="all-bids-results-header">
            <span id="resultsCount" class="results-count">전체 결과를 불러오는 중...</span>
            <div class="result-type-segmented">
              <div class="result-tab active" data-type="all">전체 <span id="allResultCount">-</span></div>
              <div class="result-tab" data-type="live">현장 <span id="liveResultCount">-</span></div>
              <div class="result-tab" data-type="direct">직접 <span id="directResultCount">-</span></div>
            </div>
          </div>

          <div class="unified-table-container">
            <table class="unified-table" id="unifiedTable">
              <thead>
                <tr>
                  <th>타입</th>
                  <th>상품 정보</th>
                  <th>고객</th>
                  <th>입찰 현황</th>
                  <th>상태</th>
                  <th>감정서</th>
                  <th>마감/수정일</th>
                  <th>빠른 작업</th>
                </tr>
              </thead>
              <tbody id="unifiedResults">
                <tr>
                  <td colspan="8" class="text-center">
                    데이터를 불러오는 중입니다...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="load-more-section">
            <button id="loadMoreBtn" class="btn btn-ghost" style="display: none">더 많은 결과 보기</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 빠른 작업 모달들 -->

    <!-- 간단한 확인 모달 -->
    <div class="modal-overlay" id="quickActionModal">
      <div class="modal-dialog">
        <div class="modal-header">
          <h3 class="modal-title" id="quickActionTitle">작업 확인</h3>
          <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
          <p id="quickActionMessage">이 작업을 수행하시겠습니까?</p>
          <div id="quickActionDetails"></div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary close-modal">취소</button>
          <button class="btn" id="confirmQuickAction">확인</button>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="allProductDetailModal">
      <div class="modal-dialog live-detail-modal">
        <div class="modal-header">
          <h3 class="modal-title">상품 상세</h3>
          <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body live-detail-body">
          <div class="live-detail-left">
            <div class="live-detail-main-image-wrap" id="allDetailMainImageWrap">
              <button type="button" class="live-detail-nav prev" id="allDetailPrevBtn">&lt;</button>
              <img id="allDetailMainImage" class="live-detail-main-image" src="/images/no-image.png" alt="상품 이미지" />
              <button type="button" class="live-detail-nav next" id="allDetailNextBtn">&gt;</button>
            </div>
            <div id="allDetailThumbs" class="live-detail-thumbs"></div>
          </div>
          <div class="live-detail-info">
            <div class="live-detail-row"><strong>상품ID</strong><span id="allDetailItemId">-</span></div>
            <div class="live-detail-row"><strong>제목</strong><span id="allDetailTitle">-</span></div>
            <div class="live-detail-row"><strong>브랜드</strong><span id="allDetailBrand">-</span></div>
            <div class="live-detail-row"><strong>카테고리</strong><span id="allDetailCategory">-</span></div>
            <div class="live-detail-row"><strong>등급</strong><span id="allDetailRank">-</span></div>
            <div class="live-detail-row"><strong>예정일시</strong><span id="allDetailScheduled">-</span></div>
            <div class="live-detail-row"><strong>액세서리코드</strong><span id="allDetailAccessoryCode">-</span></div>
            <div class="live-detail-row"><strong>설명</strong><span id="allDetailDescription">-</span></div>
            <div class="live-detail-row"><strong>원본링크</strong><a id="allDetailOriginLink" href="#" target="_blank" rel="noopener noreferrer">열기</a></div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary close-modal">닫기</button>
        </div>
      </div>
    </div>

    <!-- 스크립트 로드 -->
    <!-- 공통 스크립트 먼저 로드 -->
    <script src="/js/common.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/calculate-fee.js"></script>

    <!-- Admin 전용 스크립트 -->
    <script src="/js/admin/common.js"></script>
    <script src="/js/admin/api.js"></script>
    <script src="/js/admin/all-bids.js"></script>
  </body>
</html>
