<!-- pages/appr/request.html -->
<!-- 감정 신청 페이지 -->
<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>감정신청 - CAS 명품감정시스템</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Noto Sans KR", sans-serif;
            color: #333;
            line-height: 1.6;
            background-color: #fff;
            /* 배경색 흰색으로 통일 */
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        /* 헤더 & 푸터 공통 스타일 (다른 appr 페이지에서 가져옴) */
        
        header {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-inner {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 0;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 40px;
        }
        
        .logo {
            font-size: 1.6rem;
            font-weight: 700;
            color: #1a2a3a;
            text-decoration: none;
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
        }
        
        .logo .cas-highlight {
            background: linear-gradient(135deg, #1a2a3a 0%, #2d4263 100%);
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .nav-desktop {
            display: none;
            align-items: center;
            gap: 8px;
            flex-wrap: nowrap;
            justify-content: flex-end;
        }
        
        .nav-desktop a {
            color: #333;
            text-decoration: none;
            font-weight: 500;
            white-space: nowrap;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }
        
        .nav-desktop a:hover {
            color: #666;
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .mobile-menu-btn {
            display: block;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .mobile-menu {
            display: none;
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            background-color: #fff;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
            z-index: 999;
        }
        
        .mobile-menu a {
            display: block;
            padding: 15px 20px;
            color: #4a5568;
            text-decoration: none;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .mobile-menu a:last-child {
            border-bottom: none;
        }
        
        @media (min-width: 768px) {
            .nav-desktop {
                display: flex !important;
                gap: 8px;
            }
            .mobile-menu-btn {
                display: none !important;
            }
        }
        
        @media (min-width: 1024px) {
            .nav-desktop {
                gap: 12px;
            }
            .nav-desktop a {
                padding: 8px 16px;
                font-size: 1rem;
            }
        }
        
        .btn-modern {
            padding: 14px 28px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-decoration: none;
        }
        
        .btn-modern:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            z-index: -1;
        }
        
        .btn-modern:hover:before {
            width: 100%;
        }
        
        .btn-modern:disabled {
            background-color: #ccc !important;
            color: #666 !important;
            cursor: not-allowed;
        }
        
        .btn-modern:disabled:before {
            width: 0;
        }
        
        .input-modern {
            border: 1px solid #e2e8f0;
            /* 테두리 추가 */
            background-color: #fff;
            /* 배경색 변경 */
            border-radius: 8px;
            padding: 14px;
            /* 패딩 조정 */
            font-size: 1rem;
            box-shadow: none;
            /* 기본 그림자 제거 */
            transition: all 0.3s;
            width: 100%;
        }
        
        .input-modern:focus {
            outline: none;
            border-color: #1a2a3a;
            /* 포커스 시 테두리 색상 변경 */
            box-shadow: 0 0 0 2px rgba(26, 42, 58, 0.1);
            /* 포커스 시 외부 그림자 */
        }
        
        textarea.input-modern {
            min-height: 120px;
            resize: vertical;
        }
        /* 감정 방식 선택 탭 */
        
        .appraisal-tabs-container {
            margin-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: -1px;
            /* 아래 선과 겹치도록 */
        }
        
        .appraisal-tab {
            display: inline-block;
            padding: 12px 25px;
            /* 패딩 증가 */
            margin-right: 5px;
            /* 탭간 간격 감소 */
            background-color: transparent;
            /* 기본 배경 투명 */
            color: #64748b;
            border: 1px solid transparent;
            /* 기본 테두리 투명 */
            border-bottom: none;
            /* 아래 테두리 없음 */
            border-radius: 8px 8px 0 0;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            bottom: -1px;
            /* 아래 선과 겹치도록 */
        }
        
        .appraisal-tab.active {
            background-color: #fff;
            color: #1a2a3a;
            font-weight: 600;
            border-color: #e2e8f0;
            /* 활성 탭 테두리 */
            border-bottom-color: #fff;
            /* 아래 테두리 흰색으로 덮기 */
        }
        
        .appraisal-form-container {
            display: none;
            background-color: #fff;
            padding: 30px;
            /* 패딩 증가 */
            border-radius: 0 8px 8px 8px;
            /* 탭 아래쪽 둥글게 */
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
            /* 약간의 그림자 */
            border: 1px solid #e2e8f0;
            /* 전체 테두리 */
            border-top: none;
            /* 탭과 연결되는 위쪽 테두리 제거 */
        }
        
        .appraisal-form-container.active {
            display: block;
        }
        
        .price-info {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            /* 패딩 증가 */
            margin-bottom: 30px;
            /* 간격 증가 */
            border-left: 4px solid #1a2a3a;
        }
        
        .price-info h3 {
            font-size: 1.15rem;
            /* 제목 크기 조정 */
            margin-bottom: 8px;
            /* 제목-내용 간격 */
        }
        
        .price-info p {
            font-size: 0.9rem;
        }
        
        .file-upload-btn {
            display: inline-block;
            background-color: #1a2a3a;
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload-btn:hover {
            background-color: #2d4263;
        }
        
        input[type="file"] {
            display: none;
        }
        
        .form-section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1a2a3a;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
            /* 구분선 스타일 변경 */
        }
        
        .form-field-label {
            display: block;
            font-weight: 500;
            color: #334155;
            /* 라벨 색상 변경 */
            margin-bottom: 8px;
        }
        
        .form-field-label .required-star {
            color: #e53e3e;
            margin-left: 2px;
        }
        
        .checkbox-group label {
            margin-right: 15px;
            font-size: 0.95rem;
            color: #4a5568;
        }
        
        .checkbox-group input[type="checkbox"] {
            margin-right: 5px;
            vertical-align: middle;
        }
        
        .file-drop-zone {
            border: 2px dashed #cbd5e0;
            /* 테두리 스타일 변경 */
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            background-color: #fdfdfe;
            /* 배경색 약간 추가 */
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .file-drop-zone:hover {
            background-color: #f8fafc;
            border-color: #a0aec0;
        }
        
        .file-list-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 5px;
            padding: 8px 10px;
            /* 패딩 조정 */
            background-color: #f8fafc;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .file-list-item .file-name {
            color: #4a5568;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-right: 10px;
        }
        
        .file-list-item .file-size {
            color: #718096;
            font-size: 0.8rem;
            white-space: nowrap;
        }
        
        .submit-button-container {
            text-align: center;
            margin-top: 30px;
            /* 상단 간격 추가 */
        }
        
        .alert-message {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        
        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
            border: 1px solid #6ee7b7;
        }
        
        .alert-error {
            background-color: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }
    </style>
</head>

<body>
    <!-- 헤더 -->
    <header>
        <div class="container">
            <div class="header-inner">
                <div class="header-left">
                    <a href="/appr" class="logo">
                        <img src="https://i.ibb.co/FqJhVh0T/image.png" alt="CAS 명품감정시스템" style="height: 40px;">
                    </a>

                    <nav class="nav-desktop">
                        <a href="/appr" class="btn-modern">홈</a>
                        <a href="/appr/request" class="btn-modern">감정신청</a>
                        <a href="/appr/result" class="btn-modern">감정번호조회</a>
                        <a href="/appr/mypage" class="btn-modern">마이페이지</a>
                        <a href="/appr/repair" class="btn-modern">까사복원시스템</a>
                        <a href="/appr/authenticity" class="btn-modern">정가품구별법</a>
                        <a href="/appr/signin" class="btn-modern">로그인</a>
                    </nav>
                </div>

                <button class="mobile-menu-btn" id="menu-icon" onclick="toggleMobileMenu()">
                    ☰
                </button>
            </div>
        </div>
    </header>

    <div class="mobile-menu" id="mobile-menu" style="
        display: none;
        position: fixed;
        top: 70px;
        left: 0;
        right: 0;
        background-color: #fff;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        z-index: 999;
    ">
        <a href="/appr" style="display: block; padding: 15px 20px; color: #4a5568; text-decoration: none; border-bottom: 1px solid #e2e8f0;">홈</a>
        <a href="/appr/request" style="display: block; padding: 15px 20px; color: #4a5568; text-decoration: none; border-bottom: 1px solid #e2e8f0;">감정신청</a>
        <a href="/appr/result" style="display: block; padding: 15px 20px; color: #4a5568; text-decoration: none; border-bottom: 1px solid #e2e8f0;">감정번호조회</a>
        <a href="/appr/mypage" style="display: block; padding: 15px 20px; color: #4a5568; text-decoration: none; border-bottom: 1px solid #e2e8f0;">마이페이지</a>
        <a href="/appr/repair" style="display: block; padding: 15px 20px; color: #4a5568; text-decoration: none; border-bottom: 1px solid #e2e8f0;">까사복원시스템</a>
        <a href="/appr/authenticity" style="display: block; padding: 15px 20px; color: #4a5568; text-decoration: none; border-bottom: 1px solid #e2e8f0;">정가품구별법</a>
        <a href="/appr/signin" style="display: block; padding: 15px 20px; color: #4a5568; text-decoration: none;">로그인</a>
    </div>

    <!-- 메인 콘텐츠 영역 -->
    <main>
        <section style="padding: 60px 0; background-color: #f8fafc">
            <div class="container" style="max-width: 800px; margin: 0 auto">
                <div style="text-align: center; margin-bottom: 40px">
                    <h1 style="
                font-size: 2.25rem;
                font-weight: 700;
                color: #1a2a3a;
                margin-bottom: 15px;
              ">
                        감정 신청
                    </h1>
                    <p style="color: #4a5568; font-size: 1.1rem; line-height: 1.7">
                        원하시는 감정 방식을 선택하고 필요한 정보를 입력해 주세요
                    </p>
                </div>

                <div id="alert-box" style="display: none"></div>

                <!-- 감정 방식 선택 탭 -->
                <div class="appraisal-tabs-container">
                    <div class="appraisal-tab active" onclick="changeTab('quicklink')" id="tab-quicklink">
                        퀵링크 감정
                    </div>
                    <div class="appraisal-tab" onclick="changeTab('offline')" id="tab-offline">
                        오프라인 실물 감정
                    </div>
                </div>

                <!-- 퀵링크 감정 폼 -->
                <div id="form-quicklink" class="appraisal-form-container active">
                    <form id="quicklink-form">
                        <input type="hidden" name="appraisal_type" value="quicklink" />
                        <div class="price-info">
                            <h3>퀵링크 감정 비용</h3>
                            <p>
                                신청 건당
                                <strong style="color: #1a2a3a">일시적 무료
                            </p>
                            <p style="margin-top: 5px; color: #64748b">
                              당근마켓, 번개장터 등 중고거래 플랫폼의 상품 링크로 빠르게
                              감정받을 수 있습니다.
                            </p>
                            <p id="quicklink-subscription-info" style="margin-top: 10px; font-size: 0.9rem; color: #4a5568; display: none;">
                              <span id="quicklink-credit-info">이번 달 남은 크레딧: <strong>10회</strong></span>
                              <br>
                              <span id="membership-info">일반회원: 월 29,000원 구독 필요 (10회 제한)</span>
                            </p>
                          </div>

                          <h2 class="form-section-title">신청자 정보 (선택)</h2>
                          <div style="margin-bottom: 20px">
                            <label for="ql-name" class="form-field-label">이름</label>
                            <input
                              type="text"
                              id="ql-name"
                              name="name"
                              class="input-modern" />
                          </div>
                          <div style="margin-bottom: 20px">
                            <label for="ql-phone" class="form-field-label">연락처</label>
                            <input
                              type="tel"
                              id="ql-phone"
                              name="phone"
                              class="input-modern" />
                          </div>
                          <div style="margin-bottom: 30px">
                            <label for="ql-email" class="form-field-label">이메일</label>
                            <input
                              type="email"
                              id="ql-email"
                              name="email"
                              class="input-modern" />
                          </div>

                          <h2 class="form-section-title">상품 정보</h2>
                          <div style="margin-bottom: 20px">
                            <label for="ql-brand" class="form-field-label"
                              >브랜드 <span class="required-star">*</span></label>
                              <input type="text" id="ql-brand" name="brand" class="input-modern" required />
                          </div>
                          <div style="margin-bottom: 20px">
                              <label for="ql-model_name" class="form-field-label">모델명 <span class="required-star">*</span></label
                              >
                              <input
                                type="text"
                                id="ql-model_name"
                                name="model_name"
                                class="input-modern"
                                required />
                            </div>
                            <div style="margin-bottom: 20px">
                              <label for="ql-category" class="form-field-label"
                                >카테고리 <span class="required-star">*</span></label
                              >
                              <input
                                type="text"
                                id="ql-category"
                                name="category"
                                class="input-modern"
                                placeholder="예: 가방, 지갑, 시계"
                                required />
                            </div>
                            <div style="margin-bottom: 20px">
                              <label for="ql-product-link" class="form-field-label"
                                >상품 링크 <span class="required-star">*</span></label
                              >
                              <input
                                type="url"
                                id="ql-product-link"
                                name="product_link"
                                class="input-modern"
                                placeholder="https://..."
                                required />
                              <p style="font-size: 0.85rem; color: #718096; margin-top: 5px">
                                정확한 URL을 입력해주세요.
                              </p>
                            </div>
                            <div style="margin-bottom: 20px">
                              <label for="ql-platform" class="form-field-label"
                                >거래 플랫폼</label
                              >
                              <select id="ql-platform" name="platform" class="input-modern">
                                <option value="">선택하세요</option>
                                <option value="당근마켓">당근마켓</option>
                                <option value="번개장터">번개장터</option>
                                <option value="중고나라">중고나라</option>
                                <option value="기타">기타</option>
                              </select>
                            </div>
                            <div style="margin-bottom: 30px">
                              <label for="ql-remarks" class="form-field-label"
                                >추가 문의사항</label
                              >
                              <textarea
                                id="ql-remarks"
                                name="remarks"
                                class="input-modern"
                                placeholder="추가로 문의하실 내용이 있다면 자유롭게 작성해주세요."></textarea>
                            </div>

                            <div style="margin-bottom: 30px">
                              <label
                                style="display: flex; align-items: center; cursor: pointer">
                                <input
                                  type="checkbox"
                                  id="ql-privacy-agree"
                                  name="privacy_agree"
                                  required
                                  style="margin-right: 10px; width: 18px; height: 18px" />
                                <span style="font-size: 0.95rem; color: #4a5568"
                                  >개인정보 수집 및 이용에 동의합니다.
                                  <span class="required-star">*</span></span
                                >
                              </label>
                          </div>

                          <div class="submit-button-container">
                              <button type="submit" class="btn-modern" style="
                                  background-color: #1a2a3a;
                                  color: #fff;
                                  border: none;
                                  padding: 16px 40px;
                                  font-size: 1.1rem;
                                ">
                                감정 신청하기
                              </button>
                          </div>
                        </form>
                    </div>

                    <!-- 오프라인 실물 감정 폼 -->
                    <div id="form-offline" class="appraisal-form-container">
                        <form id="offline-form">
                            <input type="hidden" name="appraisal_type" value="offline" />
                            <div class="price-info">
                                <h3>오프라인 실물 감정 비용</h3>
                                <p>
                                    신청 건당
                                    <strong id="offline-price" style="color: #1a2a3a">38,000원</strong>
                                    <span id="offline-discount" style="display: none; font-size: 0.9rem; color: #059669;">(회원 할인 적용)</span>
                                </p>
                                <p style="margin-top: 5px; color: #64748b">
                                    전문가가 직접 실물을 확인하는 가장 정확한 감정 방식입니다.
                                </p>
                                <p id="offline-membership-info" style="margin-top: 10px; font-size: 0.9rem; color: #4a5568;">
                                  <span id="casatrade-info" style="display: none;">까사트레이드 회원: <strong>12,000원</strong> (할인 적용)</span>
                                  <span id="partner-info" style="display: none;">제휴사 회원: <strong>20,000원</strong> (할인 적용)</span>
                                </p>
                            </div>

                            <div style="
                              background-color: #ebf4ff;
                              border-radius: 8px;
                              padding: 20px;
                              margin-bottom: 30px;
                            ">
                                <h3 style="
                            font-size: 1.1rem;
                            font-weight: 600;
                            margin-bottom: 10px;
                            color: #1a4ea3;
                          ">
                            오프라인 실물 감정 안내
                        </h3>
                        <div style="
                          background-color: white;
                          padding: 15px;
                          border-radius: 6px;
                          margin-bottom: 15px;
                        ">
                            <p style="
                          font-weight: 600;
                          color: #1a2a3a;
                          margin-bottom: 5px;
                        ">
                            상품 보내실 주소
                        </p>
                        <p style="
                          color: #4a5568;
                          line-height: 1.6;
                          font-size: 0.95rem;
                        ">
                            까사트레이드 (02-2659-9640)<br />
                            서울 은평구 갈현동 409-2 우측문 2층
                        </p>
                    </div>
                    <ul style="
                        list-style-type: none;
                        padding-left: 0;
                        margin-bottom: 0;
                        font-size: 0.9rem;
                        color: #334155;
                      ">
                        <li style="margin-bottom: 5px">
                          • 신청 후 상품을 위 주소로 택배 발송해주세요. (선불 발송 권장)
                        </li>
                        <li style="margin-bottom: 5px">
                          • 발송 후 운송장 번호를 카카오톡 채널 또는 문자로 알려주시면 빠른 처리가 가능합니다.
                        </li>
                        <li>
                          • 감정 완료 후 제품은 안전하게 반송해 드립니다. (반송 택배비는 감정 비용에 포함)
                        </li>
                    </ul>
                    </div>

                    <h2 class="form-section-title">신청자 정보</h2>
                    <div style="margin-bottom: 20px; display: flex; align-items: center;">
                        <input type="checkbox" id="use-member-info" name="use-member-info" style="margin-right: 10px;">
                        <label for="use-member-info" style="cursor: pointer; color: #1a4ea3; font-weight: 500;">회원 정보 그대로 사용하기</label>
                    </div>
                    <div style="margin-bottom: 20px">
                        <label for="of-name" class="form-field-label">이름 <span class="required-star">*</span></label
                >
                <input
                  type="text"
                  id="of-name"
                  name="name"
                  class="input-modern"
                  required />
              </div>
              <div style="margin-bottom: 20px">
                <label for="of-phone" class="form-field-label"
                  >연락처 <span class="required-star">*</span></label
                >
                <input
                  type="tel"
                  id="of-phone"
                  name="phone"
                  class="input-modern"
                  required />
              </div>
              <div style="margin-bottom: 30px">
                <label for="of-email" class="form-field-label">이메일</label>
                            <input type="email" id="of-email" name="email" class="input-modern" />
                        </div>

                        <h2 class="form-section-title">상품 반송 정보</h2>
                        <div style="margin-bottom: 20px; display: flex; align-items: center;">
                                <input type="checkbox" id="use-member-address" name="use-member-address" style="margin-right: 10px;">
                                <label for="use-member-address" style="cursor: pointer; color: #1a4ea3; font-weight: 500;">회원 주소 그대로 사용하기</label>
                        </div>
                        <div style="margin-bottom: 20px">
                            <label for="of-zipcode" class="form-field-label">우편번호 <span class="required-star">*</span></label
                >
                <div style="display: flex; gap: 10px">
                  <input
                    type="text"
                    id="of-zipcode"
                    name="zipcode"
                    class="input-modern"
                    style="flex: 1"
                    required
                    readonly />
                  <button
                    type="button"
                    onclick="findOfflineAddress()"
                    class="btn-modern"
                    style="
                      background-color: #1a2a3a;
                      color: #fff;
                      border: none;
                      padding: 14px 20px;
                      white-space: nowrap;
                    ">
                    주소 찾기
                  </button>
                </div>
              </div>
              <div style="margin-bottom: 10px">
                <label for="of-address1" class="form-field-label"
                  >기본 주소 <span class="required-star">*</span></label
                >
                <input
                  type="text"
                  id="of-address1"
                  name="address1"
                  class="input-modern"
                  required
                  readonly />
              </div>
              <div style="margin-bottom: 30px">
                <label for="of-address2" class="form-field-label"
                  >상세 주소</label
                >
                <input
                  type="text"
                  id="of-address2"
                  name="address2"
                  class="input-modern"
                  placeholder="상세주소를 입력하세요" />
              </div>

              <h2 class="form-section-title">상품 정보</h2>
              <div style="margin-bottom: 20px">
                <label for="of-brand" class="form-field-label"
                  >브랜드 <span class="required-star">*</span></label
                >
                <input
                  type="text"
                  id="of-brand"
                  name="brand"
                  class="input-modern"
                  required />
              </div>
              <div style="margin-bottom: 20px">
                <label for="of-model_name" class="form-field-label"
                  >모델명 <span class="required-star">*</span></label
                >
                <input
                  type="text"
                  id="of-model_name"
                  name="model_name"
                  class="input-modern"
                  required />
              </div>
              <div style="margin-bottom: 20px">
                <label for="of-category" class="form-field-label"
                  >카테고리 <span class="required-star">*</span></label
                >
                <input
                  type="text"
                  id="of-category"
                  name="category"
                  class="input-modern"
                  placeholder="예: 가방, 지갑, 시계"
                  required />
              </div>
              <div style="margin-bottom: 20px">
                <label for="of-purchase-year" class="form-field-label"
                  >구매 연도</label
                >
                <input
                  type="text"
                  id="of-purchase-year"
                  name="purchase_year"
                  class="input-modern"
                  placeholder="예: 2020" />
              </div>
              <div style="margin-bottom: 30px">
                <label class="form-field-label">보유 구성품</label>
                            <div class="checkbox-group">
                                <label><input
                      type="checkbox"
                      name="components_included"
                      value="box" />
                    박스</label
                  >
                  <label
                    ><input
                      type="checkbox"
                      name="components_included"
                      value="dustbag" />
                    더스트백</label
                  >
                  <label
                    ><input
                      type="checkbox"
                      name="components_included"
                      value="guarantee-card" />
                    보증카드</label
                  >
                  <label
                    ><input
                      type="checkbox"
                      name="components_included"
                      value="receipt" />
                    영수증</label
                  >
                  <label
                    ><input
                      type="checkbox"
                      name="components_included"
                      value="tag" />
                    택</label
                  >
                </div>
              </div>

              <div style="margin-bottom: 30px">
                <label for="of-remarks" class="form-field-label"
                  >특이사항 또는 추가 문의</label
                >
                <textarea
                  id="of-remarks"
                  name="remarks"
                  class="input-modern"
                  placeholder="상품의 특이사항이나 택배 발송 시 참고사항 등을 입력해 주세요"></textarea>
              </div>

              <div style="margin-bottom: 30px">
                <label
                  style="display: flex; align-items: center; cursor: pointer">
                  <input
                    type="checkbox"
                    id="of-privacy-agree"
                    name="privacy_agree"
                    required
                    style="margin-right: 10px; width: 18px; height: 18px" />
                  <span style="font-size: 0.95rem; color: #4a5568"
                    >개인정보 수집 및 이용에 동의합니다.
                    <span class="required-star">*</span></span
                  >
                </label>
                            </div>

                            <div class="submit-button-container">
                                <button type="submit" class="btn-modern" style="
                    background-color: #1a2a3a;
                    color: #fff;
                    border: none;
                    padding: 16px 40px;
                    font-size: 1.1rem;
                  ">
                  감정 신청하기
                </button>
                            </div>
                    </form>
                    </div>
                </div>
        </section>
    </main>

    <!-- 푸터 -->
    <footer style="background-color: #1a2a3a; color: #fff; padding: 40px 0 20px">
        <div class="container">
            <div style="
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 30px;
            margin-bottom: 30px;
          " class="grid-3">
                <div>
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 15px">
                        <span style="font-size: 0.9rem; vertical-align: top">ⓒ</span> CAS 명품감정시스템
                    </h3>
                    <p style="color: #cbd5e0; margin-bottom: 20px">
                        최고의 전문가들이 함께하는<br />국내 최고 명품 감정 서비스
                    </p>
                </div>
                <div>
                    <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: 15px">
                        서비스
                    </h3>
                    <ul style="list-style: none; padding: 0; margin: 0">
                        <li style="margin-bottom: 10px">
                            <a href="/appr/request" style="color: #cbd5e0; text-decoration: none">감정 신청</a
                >
              </li>
              <li style="margin-bottom: 10px">
                <a
                  href="/appr/result"
                  style="color: #cbd5e0; text-decoration: none"
                  >감정서 조회</a
                >
              </li>
              <li style="margin-bottom: 10px">
                <a
                  href="/appr/repair"
                  style="color: #cbd5e0; text-decoration: none"
                  >까사복원시스템</a
                >
              </li>
              <li style="margin-bottom: 10px">
                <a
                  href="/appr/authenticity"
                  style="color: #cbd5e0; text-decoration: none"
                  >정가품구별법</a
                >
              </li>
              <li>
                <a href="/appr/mypage" style="color: #cbd5e0; text-decoration: none"
                  >마이페이지</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h3
              style="font-size: 1.1rem; font-weight: 700; margin-bottom: 15px">
              정보
            </h3>
            <ul style="list-style: none; padding: 0; margin: 0">
              <li style="margin-bottom: 10px">
                <a href="#" style="color: #cbd5e0; text-decoration: none"
                  >회사 소개</a
                >
              </li>
              <li style="margin-bottom: 10px">
                <a href="#" style="color: #cbd5e0; text-decoration: none"
                  >이용약관</a
                >
              </li>
              <li>
                <a href="#" style="color: #cbd5e0; text-decoration: none"
                  >개인정보처리방침</a
                >
              </li>
            </ul>
          </div>
        </div>
        <div
          style="
            border-top: 1px solid #2d3748;
            padding-top: 20px;
            text-align: center;
            color: #a0aec0;
            font-size: 0.875rem;
          ">
          <p>© 2025 CAS 명품감정시스템. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Daum 우편번호 서비스 스크립트 -->
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script>
      function toggleMobileMenu() {
        const mobileMenu = document.getElementById("mobile-menu");
        const menuIcon = document.getElementById("menu-icon");
        if (mobileMenu.style.display === "block") {
          mobileMenu.style.display = "none";
          if (menuIcon) menuIcon.textContent = "☰";
        } else {
          mobileMenu.style.display = "block";
          if (menuIcon) menuIcon.textContent = "✕";
        }
      }

      function changeTab(tabId) {
        document
          .querySelectorAll(".appraisal-tab")
          .forEach((tab) => tab.classList.remove("active"));
        document
          .querySelectorAll(".appraisal-form-container")
          .forEach((form) => form.classList.remove("active"));
        document.getElementById(`tab-${tabId}`).classList.add("active");
        document.getElementById(`form-${tabId}`).classList.add("active");
        // 탭 변경 시 URL 파라미터 업데이트 (페이지 새로고침 없이)
        const url = new URL(window.location);
        url.searchParams.set("tab", tabId);
        window.history.pushState({}, "", url);
      }

      function findOfflineAddress() {
        new daum.Postcode({
          oncomplete: function (data) {
            document.getElementById("of-zipcode").value = data.zonecode;
            document.getElementById("of-address1").value = data.address;
            document.getElementById("of-address2").focus();
          },
        }).open();
      }

      function formatFileSize(bytes) {
        if (bytes === 0) return "0 B";
        const k = 1024;
        const sizes = ["B", "KB", "MB", "GB", "TB"];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
      }

      function displaySelectedFiles(fileInput, fileListDiv) {
        fileListDiv.innerHTML = ""; // 기존 목록 초기화
        if (fileInput.files.length > 0) {
          const fileCountP = document.createElement("p");
          fileCountP.style.fontWeight = "500";
          fileCountP.style.marginBottom = "10px";
          fileCountP.textContent = `${fileInput.files.length}개의 파일이 선택되었습니다.`;
          fileListDiv.appendChild(fileCountP);

          Array.from(fileInput.files).forEach((file) => {
            const fileItemDiv = document.createElement("div");
            fileItemDiv.className = "file-list-item";

            const fileNameSpan = document.createElement("span");
            fileNameSpan.className = "file-name";
            fileNameSpan.textContent = file.name;

            const fileSizeSpan = document.createElement("span");
            fileSizeSpan.className = "file-size";
            fileSizeSpan.textContent = formatFileSize(file.size);

            fileItemDiv.appendChild(fileNameSpan);
            fileItemDiv.appendChild(fileSizeSpan);
            fileListDiv.appendChild(fileItemDiv);
          });
        }
      }

      function showAlert(message, type = "error") {
        const alertBox = document.getElementById("alert-box");
        alertBox.innerHTML = `<div class="alert-message alert-${type}">${message}</div>`;
        alertBox.style.display = "block";
        // 일정 시간 후 자동으로 사라지게 하려면 setTimeout 사용
        // setTimeout(() => { alertBox.style.display = 'none'; }, 5000);
      }

      document.addEventListener("DOMContentLoaded", function () {
        const mobileMenuButton = document.querySelector(".mobile-menu-btn");
        const navDesktop = document.querySelector(".nav-desktop");

        function handleResponsiveLayout() {
          if (window.innerWidth >= 768) {
            if (navDesktop) navDesktop.style.display = "flex";
            if (mobileMenuButton) mobileMenuButton.style.display = "none";
            const mobileMenu = document.getElementById("mobile-menu");
            if (mobileMenu) mobileMenu.style.display = "none";
          } else {
            if (navDesktop) navDesktop.style.display = "none";
            if (mobileMenuButton) mobileMenuButton.style.display = "block";
          }
        }
        handleResponsiveLayout();
        window.addEventListener("resize", handleResponsiveLayout);

        const urlParams = new URLSearchParams(window.location.search);
        const initialTab = urlParams.get("tab");
        if (
          initialTab &&
          ["quicklink", "offline"].includes(initialTab)
        ) {
          changeTab(initialTab);
        } else {
          changeTab("quicklink"); // 기본 탭
        }

        // 폼 제출 공통 로직
        const forms = {
          "quicklink-form": document.getElementById("quicklink-form"),
          "offline-form": document.getElementById("offline-form"),
        };

        for (const formId in forms) {
          const formElement = forms[formId];
          if (formElement) {
            formElement.addEventListener("submit", async function (event) {
              event.preventDefault();
              const submitButton = formElement.querySelector(
                'button[type="submit"]'
              );
              submitButton.disabled = true;
              submitButton.textContent = "신청 중...";
              document.getElementById("alert-box").style.display = "none"; // 이전 알림 숨기기

              const formData = new FormData(formElement);
              const requestData = {};

              // 공통 필드 및 각 폼의 고유 필드 처리
              requestData.appraisal_type = formData.get("appraisal_type");

              // 퀵링크, 오프라인에 따라 필요한 필드 선택적 추가
              if (requestData.appraisal_type === "quicklink") {
                requestData.brand = formData.get("brand");
                requestData.model_name = formData.get("model_name");
                requestData.category = formData.get("category");
                requestData.product_link = formData.get("product_link");
                if (formData.get("platform"))
                  requestData.platform = formData.get("platform");
              } else if (requestData.appraisal_type === "offline") {
                requestData.brand = formData.get("brand");
                requestData.model_name = formData.get("model_name");
                requestData.category = formData.get("category");
                if (formData.get("purchase_year"))
                  requestData.purchase_year = formData.get("purchase_year");

                const components = [];
                formElement
                  .querySelectorAll('input[name="components_included"]:checked')
                  .forEach((cb) => components.push(cb.value));
                if (components.length > 0)
                  requestData.components_included = components;

                requestData.delivery_info = {
                  name: formData.get("name"), // 신청자 이름을 반송받는 사람 이름으로 사용 (필요시 폼에 별도 필드 추가)
                  phone: formData.get("phone"), // 신청자 연락처
                  zipcode: formData.get("zipcode"),
                  address1: formData.get("address1"),
                  address2: formData.get("address2") || "",
                };
              }
              if (formData.get("remarks"))
                requestData.remarks = formData.get("remarks");

              // (임시) 신청자 정보 (선택 사항이므로 값이 있을 때만 추가)
              if (formData.get("name"))
                requestData.applicant_name = formData.get("name");
              if (formData.get("phone"))
                requestData.applicant_phone = formData.get("phone");
              if (formData.get("email"))
                requestData.applicant_email = formData.get("email");

                // 결제 정보는 별도 API(/api/appr/payments/prepare)로 처리되므로 여기서는 제외
                // if (requestData.appraisal_type === "offline") {
                //   // 오프라인 감정은 결제가 필요할 수 있으므로 결제 페이지로 리다이렉트 처리 예정
                // }

              try {
                const response = await fetch("/api/appr/appraisals", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify(requestData),
                });
                const result = await response.json();

                if (result.success) {
                  showAlert(
                    `감정 신청이 성공적으로 접수되었습니다. (감정 ID: ${
                      result.appraisal?.id || "확인 불가"
                    }) 곧 담당자가 연락드릴 예정입니다.`,
                    "success"
                  );
                  formElement.reset();
                } else {
                  showAlert(
                    result.message ||
                      "감정 신청에 실패했습니다. 입력 내용을 확인해주세요."
                  );
                }
              } catch (error) {
                console.error("감정 신청 오류:", error);
                showAlert(
                  "감정 신청 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요."
                );
              } finally {
                submitButton.disabled = false;
                submitButton.textContent = "감정 신청하기";
              }
            });
          }
        }

        // 회원 정보 로드 및 가격 업데이트
        loadMembershipInfo();
        
        // 탭 전환 처리
        const tabQuicklink = document.getElementById('tab-quicklink');
        const tabOffline = document.getElementById('tab-offline');
        const formQuicklink = document.getElementById('form-quicklink');
        const formOffline = document.getElementById('form-offline');
        
        tabQuicklink.addEventListener('click', function() {
            tabQuicklink.classList.add('active');
            tabOffline.classList.remove('active');
            formQuicklink.classList.add('active');
            formOffline.classList.remove('active');
        });
        
        tabOffline.addEventListener('click', function() {
            tabOffline.classList.add('active');
            tabQuicklink.classList.remove('active');
            formOffline.classList.add('active');
            formQuicklink.classList.remove('active');
        });
        
        // 회원 정보 로드 및 가격 정보 업데이트 함수
        function loadMembershipInfo() {
            // 실제 구현에서는 API 호출
            fetch('/api/appr/appraisals/my', { credentials: 'include' })
              .then(response => response.json())
              .then(data => {
                if(data.success) {
                  // user_info, membership_info를 사용하여 UI 업데이트
                  if (data.user_info) { // 정보 자동 채우기
                    if (document.getElementById('ql-name')) document.getElementById('ql-name').value = data.user_info.name || '';
                    if (document.getElementById('ql-phone')) document.getElementById('ql-phone').value = data.user_info.phone || '';
                    if (document.getElementById('ql-email')) document.getElementById('ql-email').value = data.user_info.email || '';
                    if (document.getElementById('of-name')) document.getElementById('of-name').value = data.user_info.name || '';
                    if (document.getElementById('of-phone')) document.getElementById('of-phone').value = data.user_info.phone || '';
                    if (document.getElementById('of-email')) document.getElementById('of-email').value = data.user_info.email || '';
                  }
                  if (data.membership_info) { // 가격 및 크레딧 정보 표시
                    updatePriceDisplay(data.membership_info);
                  }
                } else {
                  // 로그인 안 되어 있거나 에러 시 기본값으로 표시
                  updatePriceDisplay({ tier: '일반회원', quick_link_credits_remaining_this_month: 0, quick_link_credits_monthly_limit: 0, offline_appraisal_fee: 38000});
                }
              })
              .catch(error => {
                console.error("회원/멤버십 정보 로드 오류:", error);
                updatePriceDisplay({ tier: '일반회원', quick_link_credits_remaining_this_month: 0, quick_link_credits_monthly_limit: 0, offline_appraisal_fee: 38000});
              });
          }
          
          function updatePriceDisplay(membership) {
            // 퀵링크 탭 가격/크레딧 정보
            const qlCreditInfoEl = document.getElementById('quicklink-credit-info');
            const qlMembershipInfoEl = document.getElementById('membership-info');
            if (qlCreditInfoEl && qlMembershipInfoEl) {
              document.getElementById('quicklink-subscription-info').style.display = 'block';
              qlCreditInfoEl.innerHTML = `이번 달 남은 크레딧: <strong>${membership.quick_link_credits_remaining_this_month}회</strong> / ${membership.quick_link_credits_monthly_limit}회`;
              if (membership.tier === '일반회원' && membership.quick_link_credits_monthly_limit === 0) { // 구독 안 한 일반 회원
                qlMembershipInfoEl.textContent = '일반회원: 월 29,000원 구독 필요 (10회 제한)';
              } else {
                qlMembershipInfoEl.textContent = `${membership.tier}: ${membership.tier !== '일반회원' ? '무료 구독' : '구독 중' } (${membership.quick_link_credits_monthly_limit}회 제한)`;
              }
            }
            
            // 오프라인 탭 가격 정보
            const offlinePriceEl = document.getElementById('offline-price');
            const offlineDiscountEl = document.getElementById('offline-discount');
            const casatradeInfoEl = document.getElementById('casatrade-info');
            const partnerInfoEl = document.getElementById('partner-info');

            if (offlinePriceEl && offlineDiscountEl && casatradeInfoEl && partnerInfoEl) {
              let price = 38000;
              let showDiscount = false;
              casatradeInfoEl.style.display = 'none';
              partnerInfoEl.style.display = 'none';

              if (membership.tier === '까사트레이드 회원') {
                price = 12000; showDiscount = true; casatradeInfoEl.style.display = 'block';
              } else if (membership.tier === '제휴사 회원') {
                price = 20000; showDiscount = true; partnerInfoEl.style.display = 'block';
              }
              offlinePriceEl.textContent = `${price.toLocaleString()}원`;
              offlineDiscountEl.style.display = showDiscount ? 'inline' : 'none';
            }
          }

        // 회원 정보 자동 채우기 기능
        document.addEventListener('DOMContentLoaded', function() {
            // 회원 정보 그대로 사용하기 체크박스
            const useMemberInfoCheckbox = document.getElementById('use-member-info');
            if (useMemberInfoCheckbox) {
                useMemberInfoCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        // 로그인한 회원 정보 가져오기 (여기서는 예시로 사용)
                        // 실제로는 서버에서 현재 로그인한 회원 정보를 가져와야 함
                        const memberName = localStorage.getItem('memberName') || '';
                        const memberPhone = localStorage.getItem('memberPhone') || '';
                        const memberEmail = localStorage.getItem('memberEmail') || '';
                        
                        // 폼에 회원 정보 채우기
                        document.getElementById('of-name').value = memberName;
                        document.getElementById('of-phone').value = memberPhone;
                        document.getElementById('of-email').value = memberEmail;
                    } else {
                        // 체크 해제 시 필드 초기화
                        document.getElementById('of-name').value = '';
                        document.getElementById('of-phone').value = '';
                        document.getElementById('of-email').value = '';
                    }
                });
            }
            
            // 회원 주소 그대로 사용하기 체크박스
            const useMemberAddressCheckbox = document.getElementById('use-member-address');
            if (useMemberAddressCheckbox) {
                useMemberAddressCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        // 로그인한 회원 주소 정보 가져오기 (여기서는 예시로 사용)
                        // 실제로는 서버에서 현재 로그인한 회원 주소 정보를 가져와야 함
                        const memberZipcode = localStorage.getItem('memberZipcode') || '';
                        const memberAddress1 = localStorage.getItem('memberAddress1') || '';
                        const memberAddress2 = localStorage.getItem('memberAddress2') || '';
                        
                        // 폼에 회원 주소 정보 채우기
                        document.getElementById('of-zipcode').value = memberZipcode;
                        document.getElementById('of-address1').value = memberAddress1;
                        document.getElementById('of-address2').value = memberAddress2;
                    } else {
                        // 체크 해제 시 필드 초기화
                        document.getElementById('of-zipcode').value = '';
                        document.getElementById('of-address1').value = '';
                        document.getElementById('of-address2').value = '';
                    }
                });
            }
        });
      });
    </script>
  </body>
</html>